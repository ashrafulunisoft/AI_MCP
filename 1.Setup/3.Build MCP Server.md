Perfect! Since you already have:

* **Laravel 12**
* **MCP package installed** (`laravel/mcp`)
* **Minimax / Ollama AI working via curl**

Now itâ€™s time to **learn how to use MCP properly inside Laravel**. Iâ€™ll break it **step by step**, so you can integrate your AI chatbot fully into Laravel MCP.

---

# **1ï¸âƒ£ What is MCP in Laravel?**

MCP = **Model Context Protocol**

In Laravel MCP, this means:

```
AI Client â†’ MCP Server â†’ Tools / Prompts / Resources â†’ Laravel App
```

* **Server**: Laravel class exposing endpoints (`/mcp/...`)
* **Prompts**: Instructions/templates AI uses
* **Tools**: Actions AI can call (CRUD, DB updates)
* **Resources**: Data/context AI can fetch (packages, orders, claims)

ğŸ’¡ Think of MCP like a **structured AI API** inside Laravel.

---

# **2ï¸âƒ£ MCP Structure in Laravel**

```
app/
 â””â”€ Mcp/
      â”œâ”€ Servers/      â†’ MCP servers
      â”œâ”€ Prompts/      â†’ AI prompts (instructions)
      â”œâ”€ Tools/        â†’ Actions AI can execute
      â””â”€ Resources/    â†’ Data AI can read
```

* **Server**: Glue that registers prompts, tools, and resources
* **Prompts**: Tell AI how to behave
* **Tools**: Execute actions (CRUD)
* **Resources**: Give AI access to DB/models

---

# **3ï¸âƒ£ Create an MCP Server**

```bash
php artisan make:mcp-server ChatServer
```

Generates: `app/Mcp/Servers/ChatServer.php`

```php
<?php

namespace App\Mcp\Servers;

use Laravel\Mcp\Server;

class ChatServer extends Server
{
    protected string $name = 'Customer Chat Server';
    protected string $version = '1.0.0';

    // Register tools
    protected array $tools = [
        \App\Mcp\Tools\CreateOrderTool::class,
        \App\Mcp\Tools\SubmitClaimTool::class,
    ];

    // Register prompts
    protected array $prompts = [
        \App\Mcp\Prompts\CustomerPrompt::class,
    ];

    // Register resources
    protected array $resources = [
        \App\Mcp\Resources\PackageResource::class,
        \App\Mcp\Resources\OrderResource::class,
    ];
}
```

âœ… **Server is the entry point**.

---

# **4ï¸âƒ£ Register MCP Server Route**

In `routes/ai.php`:

```php
use App\Mcp\Servers\ChatServer;
use Laravel\Mcp\Facades\Mcp;

Mcp::web('/mcp/chat', ChatServer::class);
```

* This exposes **`POST /mcp/chat`** for AI clients.
* Any AI client (curl, ChatGPT, Claude, Ollama) can now call it.

---

# **5ï¸âƒ£ Create a Prompt**

Prompts are **instructions for the AI**.

```bash
php artisan make:mcp-prompt CustomerPrompt
```

`app/Mcp/Prompts/CustomerPrompt.php`:

```php
<?php

namespace App\Mcp\Prompts;

use Laravel\Mcp\Prompt\Prompt;
use Laravel\Mcp\Response;

class CustomerPrompt extends Prompt
{
    public function handle($request): Response
    {
        $userMessage = $request->get('message');

        return Response::text("
You are a smart insurance assistant.
Reply in Bangla if user writes Bangla, English if English.
Use JSON intents:
{
  'intent': 'list_packages | create_order | submit_claim | get_user_info | faq | unknown',
  'data': {}
}
Message: $userMessage
");
    }
}
```

âœ… Prompts define **how AI should structure output**.

---

# **6ï¸âƒ£ Create a Tool**

Tools are **actions AI can execute**, e.g., create order.

```bash
php artisan make:mcp-tool CreateOrderTool
```

`app/Mcp/Tools/CreateOrderTool.php`:

```php
<?php

namespace App\Mcp\Tools;

use Laravel\Mcp\Tool\Tool;
use App\Models\Order;
use Illuminate\Support\Facades\Auth;

class CreateOrderTool extends Tool
{
    public string $name = 'create_order';

    public function handle(array $data)
    {
        $user = Auth::user();
        $order = Order::create([
            'user_id' => $user->id,
            'package_id' => $data['package_id']
        ]);

        return "Order #{$order->id} created successfully!";
    }
}
```

---

# **7ï¸âƒ£ Create a Resource**

Resources give AI **read access to DB**.

```bash
php artisan make:mcp-resource PackageResource
```

`app/Mcp/Resources/PackageResource.php`:

```php
<?php

namespace App\Mcp\Resources;

use Laravel\Mcp\Resource\Resource;
use App\Models\Package;

class PackageResource extends Resource
{
    public string $name = 'packages';

    public function handle()
    {
        return Package::all(['id','name','price'])->toArray();
    }
}
```

---

# **8ï¸âƒ£ Calling MCP from Laravel / Curl**

Now you can call MCP like this:

```bash
curl -X POST http://localhost:8000/mcp/chat \
-H "Content-Type: application/json" \
-d '{
    "messages": [
        {
            "role": "user",
            "content": "Create order for package 2"
        }
    ]
}'
```

AI will:

1. Read **prompt instructions**
2. Detect **intent** (`create_order`)
3. Call **Tool** â†’ Order created in DB
4. Return response

âœ… Full CRUD + AI integration via MCP.

---

# **9ï¸âƒ£ MCP Workflow Recap**

```
AI Client â†’ /mcp/chat â†’ ChatServer
    â†’ Prompts â†’ Structures AI response
    â†’ Tools â†’ Executes actions (CRUD)
    â†’ Resources â†’ Provides data context
    â†’ Response back to AI Client
```

---

# **10ï¸âƒ£ Next Steps**

1. Upgrade **chat frontend** â†’ connect MCP endpoint
2. Add **Redis memory** â†’ multi-turn conversations
3. Add **intent detection JSON** in prompt (already done)
4. Optional â†’ **multi-agent MCP**

---

If you want, I can create a **full working Laravel MCP chatbot** with:

* **Orders / Packages / Claims CRUD**
* **Redis conversation memory**
* **Frontend live chat**
* **Ollama Pi model**

All in **one ready-to-run package**.

Do you want me to do that next?
